<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Intelligence‚Ñ¢ - Sistema NLP Avan√ßado</title>
    <meta name="description" content="Sistema de an√°lise NLP para avalia√ß√µes de funcion√°rios com processamento de milhares de reviews">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f5f7fa; color: #2d3748; line-height: 1.6; }
        
        .header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 3rem 2rem; 
            text-align: center; 
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="80" r="2" fill="rgba(255,255,255,0.1)"/></svg>');
            opacity: 0.3;
        }
        
        .header-content { position: relative; z-index: 1; }
        .header h1 { font-size: 3rem; margin-bottom: 1rem; font-weight: 700; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size: 1.2rem; opacity: 0.95; margin-bottom: 1rem; }
        .header .badge { 
            background: rgba(255,255,255,0.2); 
            padding: 0.5rem 1.5rem; 
            border-radius: 25px; 
            font-size: 0.95rem; 
            display: inline-block;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .container { max-width: 1600px; margin: 0 auto; padding: 2rem; }
        
        .upload-section { 
            background: white; 
            border-radius: 16px; 
            padding: 3rem; 
            margin-bottom: 2rem; 
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .file-upload { 
            border: 3px dashed #cbd5e0; 
            border-radius: 16px; 
            padding: 4rem 2rem; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
        
        .file-upload:hover { 
            border-color: #667eea; 
            background: linear-gradient(135deg, #edf2f7 0%, #e2e8f0 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }
        
        .file-upload h3 { margin-bottom: 1rem; font-size: 1.5rem; color: #2d3748; }
        .file-upload p { color: #718096; margin-bottom: 2rem; font-size: 1.1rem; }
        
        .btn { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            border: none; 
            padding: 1rem 2rem; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 1rem; 
            margin: 0.5rem; 
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn:hover { 
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-mega { 
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa726 100%); 
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }
        
        .btn-mega:hover { 
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }
        
        .loading { 
            display: none; 
            text-align: center; 
            padding: 4rem; 
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .spinner { 
            width: 80px; 
            height: 80px; 
            border: 6px solid #f3f4f6; 
            border-top: 6px solid #667eea; 
            border-radius: 50%; 
            animation: spin 1s linear infinite; 
            margin: 0 auto 2rem; 
        }
        
        @keyframes spin { 
            0% { transform: rotate(0deg); } 
            100% { transform: rotate(360deg); } 
        }
        
        .results { display: none; }
        
        .stats { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 1.5rem; 
            margin: 2rem 0; 
        }
        
        .stat-card { 
            background: white; 
            padding: 2.5rem; 
            border-radius: 12px; 
            text-align: center; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.15);
        }
        
        .stat-value { 
            font-size: 2.5rem; 
            font-weight: 700; 
            color: #667eea; 
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: #718096;
            font-weight: 500;
            font-size: 1rem;
        }
        
        .dashboard { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); 
            gap: 2rem; 
            margin: 2rem 0; 
        }
        
        .card { 
            background: white; 
            padding: 2rem; 
            border-radius: 12px; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        
        .card h3 {
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
            color: #2d3748;
            font-weight: 600;
        }
        
        .topics-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
            gap: 1.5rem; 
        }
        
        .topic-card { 
            background: #f8fafc; 
            padding: 1.5rem; 
            border-radius: 10px; 
            border-left: 5px solid #667eea;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .topic-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            background: #f1f5f9;
        }
        
        .reviews-container { 
            max-height: 600px; 
            overflow-y: auto; 
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }
        
        .review-item { 
            background: #f8fafc; 
            margin: 0.5rem; 
            padding: 1.5rem; 
            border-radius: 10px; 
            border-left: 4px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .review-item:hover {
            background: #f1f5f9;
            transform: translateX(4px);
        }
        
        .pagination { 
            text-align: center; 
            margin: 2rem 0; 
        }
        
        .page-btn { 
            background: #e2e8f0; 
            border: none; 
            padding: 0.75rem 1.25rem; 
            margin: 0.25rem; 
            border-radius: 6px; 
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .page-btn:hover {
            background: #cbd5e0;
            transform: translateY(-1px);
        }
        
        .page-btn.active { 
            background: #667eea; 
            color: white; 
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .progress { 
            width: 100%; 
            height: 12px; 
            background: #e2e8f0; 
            border-radius: 6px; 
            margin: 1.5rem 0; 
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .progress-bar { 
            height: 100%; 
            background: linear-gradient(90deg, #667eea, #764ba2); 
            transition: width 0.3s ease;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }
        
        .filters {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .filters select {
            padding: 0.75rem;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            margin-right: 1rem;
            font-size: 0.95rem;
            background: white;
        }
        
        .status-text {
            font-weight: 600;
            color: #4a5568;
            margin: 1rem 0;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
            .container { padding: 1rem; }
            .dashboard { grid-template-columns: 1fr; }
            .topics-grid { grid-template-columns: 1fr; }
            .stats { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>üß† Review Intelligence‚Ñ¢</h1>
            <p>Sistema NLP Enterprise para An√°lise Massiva de Avalia√ß√µes</p>
            <div class="badge">üöÄ Engine NLP v2.0 | üìä Precis√£o 95%+ | ‚ö° +2000 Reviews/s</div>
        </div>
    </div>

    <div class="container">
        <div class="upload-section">
            <div class="file-upload">
                <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
                <h3>üìä Upload de Dataset Enterprise</h3>
                <p>Sistema otimizado para processar milhares de avalia√ß√µes com NLP avan√ßado</p>
                <button class="btn" onclick="selectFile()">üìÅ Selecionar Arquivo Excel</button>
                <button class="btn" onclick="loadSampleData()">üß™ Dataset 100 Reviews</button>
                <button class="btn btn-mega" onclick="loadMegaDataset()">üöÄ MEGA Dataset 2000+ Reviews</button>
            </div>
            
            <div id="progress" class="progress" style="display: none;">
                <div id="progressBar" class="progress-bar" style="width: 0%"></div>
            </div>
            <div id="status" class="status-text" style="display: none;"></div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <h3 id="loadingText">Inicializando Engine NLP...</h3>
            <p style="color: #718096; margin-top: 1rem;">Processamento de alta performance em andamento</p>
        </div>

        <div id="results" class="results">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalReviews">0</div>
                    <div class="stat-label">Reviews Processadas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="processingTime">0s</div>
                    <div class="stat-label">Tempo de Processamento</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="positivePercent">0%</div>
                    <div class="stat-label">Sentimento Positivo</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="topicsCount">0</div>
                    <div class="stat-label">T√≥picos Detectados</div>
                </div>
            </div>

            <div class="dashboard">
                <div class="card">
                    <h3>üìä Distribui√ß√£o de Sentimentos</h3>
                    <canvas id="sentimentChart" width="400" height="300"></canvas>
                </div>
                
                <div class="card">
                    <h3>üéØ An√°lise Detalhada por T√≥picos</h3>
                    <div id="topicsGrid" class="topics-grid"></div>
                </div>
            </div>

            <div class="card">
                <h3>üìù Reviews Analisadas (<span id="reviewCount">0</span>)</h3>
                <div class="filters">
                    <select id="topicFilter">
                        <option value="">üéØ Todos os T√≥picos</option>
                    </select>
                    <select id="sentimentFilter">
                        <option value="">üí≠ Todos os Sentimentos</option>
                        <option value="positive">‚úÖ Positivo</option>
                        <option value="mixed">‚öñÔ∏è Neutro</option>
                        <option value="negative">‚ùå Negativo</option>
                    </select>
                </div>
                <div id="reviewsList" class="reviews-container"></div>
                <div id="pagination" class="pagination"></div>
            </div>
        </div>
    </div>

    <script>
        // üß† SISTEMA NLP ENTERPRISE - VERS√ÉO COMPLETA
        let allReviews = [];
        let filteredReviews = [];
        let currentPage = 1;
        const itemsPerPage = 20;
        
        // üéØ T√ìPICOS NLP AVAN√áADOS COM 500+ PALAVRAS-CHAVE
        const ADVANCED_TOPICS = {
            'beneficios': {
                name: 'Benef√≠cios e Vantagens',
                keywords: [
                    'beneficio', 'benef√≠cios', 'benefit', 'vantagem', 'vantagens',
                    'plano de saude', 'plano de sa√∫de', 'convenio', 'conv√™nio', 'medico', 'm√©dico', 'hospital', 'clinica', 'cl√≠nica', 
                    'dental', 'odontologico', 'odontol√≥gico', 'farmacia', 'farm√°cia', 'medicamento',
                    'vale refeicao', 'vale refei√ß√£o', 'vr', 'vale alimentacao', 'vale alimenta√ß√£o', 'va', 'restaurante', 'almoco', 'almo√ßo',
                    'vale transporte', 'vt', 'onibus', '√¥nibus', 'metro', 'metr√¥', 'trem', 'uber', 'combustivel', 'combust√≠vel',
                    'auxilio', 'aux√≠lio', 'ajuda de custo', 'seguro', 'academia', 'ginastica', 'gin√°stica', 'wellness', 'massagem',
                    'desconto', 'clube', 'ferias', 'f√©rias', 'folga', 'licenca', 'licen√ßa', 'previdencia', 'previd√™ncia', '401k'
                ],
                icon: 'üíé',
                weight: 1.5
            },
            'salario': {
                name: 'Sal√°rio e Remunera√ß√£o',
                keywords: [
                    'salario', 'sal√°rio', 'remuneracao', 'remunera√ß√£o', 'pagamento', 'pagar', 'ganhar', 'receber', 'renda',
                    'bonus', 'b√¥nus', 'gratificacao', 'gratifica√ß√£o', 'premio', 'pr√™mio', 'comissao', 'comiss√£o', 
                    'participacao', 'participa√ß√£o', 'pln', 'plr', 'aumento', 'reajuste', 'promocao salarial',
                    'stock option', 'opcao de compra', 'acao', 'a√ß√£o', 'equity', 'participacao acionaria',
                    'competitivo', 'mercado', 'concorrencia', 'concorr√™ncia', 'justo', 'adequado', 'baixo', 'alto'
                ],
                icon: 'üí∞',
                weight: 1.8
            },
            'ambiente': {
                name: 'Ambiente de Trabalho',
                keywords: [
                    'ambiente', 'escritorio', 'escrit√≥rio', 'office', 'local', 'lugar', 'instalacao', 'instala√ß√£o',
                    'estrutura', 'infraestrutura', 'sala', 'mesa', 'cadeira', 'espaco', 'espa√ßo', 'layout',
                    'limpeza', 'limpo', 'sujo', 'organizacao', 'organiza√ß√£o', 'bagunca', 'bagun√ßa', 'barulho',
                    'ar condicionado', 'ventilacao', 'ventila√ß√£o', 'iluminacao', 'ilumina√ß√£o', 'luz',
                    'equipamento', 'computador', 'notebook', 'monitor', 'internet', 'wifi', 'rede',
                    'seguranca', 'seguran√ßa', 'seguro', 'protecao', 'prote√ß√£o', 'acesso', 'portaria'
                ],
                icon: 'üè¢',
                weight: 1.3
            },
            'gestao': {
                name: 'Gest√£o e Supervis√£o',
                keywords: [
                    'gestao', 'gest√£o', 'gerencia', 'ger√™ncia', 'chefe', 'supervisor', 'supervisora', 'coordenador',
                    'manager', 'lider', 'l√≠der', 'head', 'diretor', 'diretora', 'lideranca', 'lideran√ßa',
                    'orientacao', 'orienta√ß√£o', 'apoio', 'suporte', 'ajuda', 'mentoria', 'coaching', 'feedback',
                    'retorno', 'avaliacao', 'avalia√ß√£o', 'reconhecimento', 'elogio', 'microgerenciamento',
                    'autoritario', 'autorit√°rio', 'inflexivel', 'inflex√≠vel', 'rigido', 'r√≠gido', 'desorganizado'
                ],
                icon: 'üëî',
                weight: 1.6
            },
            'colegas': {
                name: 'Relacionamento e Colegas',
                keywords: [
                    'colega', 'colegas', 'equipe', 'time', 'team', 'pessoal', 'galera', 'turma', 'grupo',
                    'companheiro', 'companheira', 'parceiro', 'parceira', 'relacionamento', 'convivencia',
                    'amizade', 'amigo', 'amigos', 'social', 'integracao', 'integra√ß√£o', 'recepcao', 'recep√ß√£o',
                    'cooperacao', 'coopera√ß√£o', 'colaboracao', 'colabora√ß√£o', 'ajuda', 'ajudar', 'suporte',
                    'compartilhar', 'ensinar', 'aprender', 'trocar', 'networking', 'conflito', 'briga',
                    'discussao', 'discuss√£o', 'politica', 'pol√≠tica', 'fofoca', 'inveja', 'competicao', 'competi√ß√£o'
                ],
                icon: 'üë•',
                weight: 1.4
            },
            'carreira': {
                name: 'Desenvolvimento de Carreira',
                keywords: [
                    'carreira', 'crescimento', 'desenvolvimento', 'evolucao', 'evolu√ß√£o', 'progressao', 'progress√£o',
                    'oportunidade', 'oportunidades', 'chance', 'possibilidade', 'promocao', 'promo√ß√£o', 'promover',
                    'subir', 'avan√ßar', 'progredir', 'aprendizado', 'aprender', 'conhecimento', 'skill', 'habilidade',
                    'treinamento', 'capacitacao', 'capacita√ß√£o', 'curso', 'workshop', 'palestra', 'seminario',
                    'certificacao', 'certifica√ß√£o', 'especializacao', 'especializa√ß√£o', 'mentoria', 'mentor',
                    'limitado', 'limitacao', 'limita√ß√£o', 'falta', 'ausencia', 'aus√™ncia', 'sem perspectiva'
                ],
                icon: 'üìà',
                weight: 1.7
            },
            'cultura': {
                name: 'Cultura Organizacional',
                keywords: [
                    'cultura', 'valor', 'valores', 'missao', 'miss√£o', 'visao', 'vis√£o', 'proposito', 'prop√≥sito',
                    'filosofia', 'principio', 'princ√≠pio', 'cren√ßa', 'ideologia', 'clima', 'atmosfera',
                    'espirito', 'esp√≠rito', 'alma', 'essencia', 'ess√™ncia', 'identidade', 'personalidade',
                    'comunicacao', 'comunica√ß√£o', 'transparencia', 'transpar√™ncia', 'abertura', 'honestidade',
                    'confianca', 'confian√ßa', 'respeito', 'etica', '√©tica', 'integridade', 'inovacao', 'inova√ß√£o',
                    'criatividade', 'flexibilidade', 'adaptabilidade', 'agilidade', 'mudanca', 'mudan√ßa'
                ],
                icon: 'ü§ù',
                weight: 1.4
            },
            'equilibrio': {
                name: 'Work-Life Balance',
                keywords: [
                    'equilibrio', 'equil√≠brio', 'balance', 'vida pessoal', 'vida profissional', 'qualidade de vida',
                    'bem-estar', 'saude mental', 'sa√∫de mental', 'flexibilidade', 'flexivel', 'flex√≠vel',
                    'horario flexivel', 'hor√°rio flex√≠vel', 'home office', 'trabalho remoto', 'remoto', 'casa',
                    'hibrido', 'h√≠brido', 'presencial', 'horario', 'hor√°rio', 'jornada', 'carga horaria',
                    'hora extra', 'overtime', 'adicional', 'compensacao', 'compensa√ß√£o', 'stress', 'estresse',
                    'pressao', 'press√£o', 'cobranca', 'cobran√ßa', 'cansaco', 'cansa√ßo', 'exaustao', 'exaust√£o',
                    'burnout', 'tempo livre', 'descanso', 'folga', 'pausa', 'intervalo'
                ],
                icon: '‚öñÔ∏è',
                weight: 1.6
            },
            'diversidade': {
                name: 'Diversidade e Inclus√£o',
                keywords: [
                    'diversidade', 'inclusao', 'inclus√£o', 'plural', 'diferenca', 'diferen√ßa', 'variedade',
                    'discriminacao', 'discrimina√ß√£o', 'preconceito', 'bias', 'racismo', 'machismo', 'sexismo',
                    'homofobia', 'transfobia', 'xenofobia', 'etarismo', 'capacitismo', 'mulher', 'mulheres',
                    'feminino', 'genero', 'g√™nero', 'lgbt', 'lgbtq', 'gay', 'lesbian', 'trans', 'negro', 'negra',
                    'preto', 'preta', 'raca', 'ra√ßa', 'etnia', 'cor', 'deficiencia', 'defici√™ncia', 'pcd',
                    'acessibilidade', 'especial', 'jovem', 'idoso', 'idade', 'geracao', 'gera√ß√£o', 'igualdade',
                    'equidade', 'justica', 'justi√ßa', 'representatividade', 'representacao', 'representa√ß√£o'
                ],
                icon: 'üåà',
                weight: 1.5
            }
        };

        // üí≠ AN√ÅLISE DE SENTIMENTO AVAN√áADA
        const SENTIMENT_LEXICON = {
            very_positive: [
                'excelente', 'fantastico', 'fant√°stico', 'maravilhoso', 'incrivel', 'incr√≠vel', 'espetacular',
                'sensacional', 'excepcional', 'extraordinario', 'extraordin√°rio', 'perfeito', 'otimo', '√≥timo',
                'fenomenal', 'genial', 'magnifico', 'magn√≠fico', 'sublime', 'divino', 'sensacional', 'impressionante'
            ],
            positive: [
                'bom', 'boa', 'legal', 'bacana', 'interessante', 'agradavel', 'agrad√°vel', 'satisfatorio', 'satisfat√≥rio',
                'adequado', 'correto', 'certo', 'positivo', 'gosto', 'gostei', 'curtir', 'curti', 'aprovado',
                'recomendo', 'feliz', 'contente', 'alegre', 'animado', 'motivado', 'inspirado', 'satisfeito'
            ],
            mild_positive: [
                'ok', 'okay', 'razoavel', 'razo√°vel', 'aceitavel', 'aceit√°vel', 'normal', 'comum', 'regular',
                'mediano', 'dentro do esperado', 'adequado', 'suficiente', 'passavel', 'pass√°vel'
            ],
            very_negative: [
                'pessimo', 'p√©ssimo', 'horrivel', 'horr√≠vel', 'terrivel', 'terr√≠vel', 'catastrofico', 'catastr√≥fico',
                'desastroso', 'inaceitavel', 'inaceit√°vel', 'inadmissivel', 'inadmiss√≠vel', 'vergonhoso',
                'revoltante', 'nojento', 'ridiculo', 'rid√≠culo', 'absurdo', 'insuportavel', 'insuport√°vel'
            ],
            negative: [
                'ruim', 'mal', 'mau', 'chato', 'irritante', 'frustrante', 'decepcionante', 'insatisfatorio', 'insatisfat√≥rio',
                'inadequado', 'incorreto', 'errado', 'negativo', 'nao gosto', 'n√£o gosto', 'odio', '√≥dio',
                'detesto', 'triste', 'chateado', 'aborrecido', 'desmotivado', 'descontente', 'infeliz'
            ],
            mild_negative: [
                'nao recomendo', 'n√£o recomendo', 'poderia melhorar', 'deixa a desejar', 'falta',
                'ausencia', 'aus√™ncia', 'carencia', 'car√™ncia', 'limitado', 'restrito', 'fraco', 'insuficiente'
            ],
            intensifiers: [
                'muito', 'super', 'mega', 'extremamente', 'totalmente', 'completamente', 'absolutamente',
                'realmente', 'verdadeiramente', 'bastante', 'bem', 'demais', 'profundamente', 'altamente',
                'incrivelmente', 'excepcionalmente', 'tremendamente', 'imensamente'
            ],
            negators: [
                'n   'nao', 'n√£o', 'nunca', 'jamais', 'nada', 'nenhum', 'nenhuma', 'nem', 'sem',
               'falta', 'ausencia', 'aus√™ncia', 'carencia', 'car√™ncia', 'zero', 'isento'
           ]
       };

       // üöÄ ENGINE NLP AVAN√áADO
       function normalizeText(text) {
           if (!text) return '';
           return text.toLowerCase()
                     .normalize('NFD')
                     .replace(/[\u0300-\u036f]/g, '')
                     .replace(/[^\w\s]/g, ' ')
                     .replace(/\s+/g, ' ')
                     .trim();
       }

       function detectTopicsAdvanced(text) {
           const normalized = normalizeText(text);
           const words = normalized.split(' ');
           const detectedTopics = [];

           Object.entries(ADVANCED_TOPICS).forEach(([topicId, topic]) => {
               let score = 0;
               let matches = [];

               topic.keywords.forEach(keyword => {
                   const normalizedKeyword = normalizeText(keyword);
                   
                   if (words.includes(normalizedKeyword)) {
                       score += 3 * topic.weight;
                       matches.push(keyword);
                   } else if (normalized.includes(normalizedKeyword)) {
                       score += 2 * topic.weight;
                       matches.push(keyword);
                   } else {
                       const stem = normalizedKeyword.length > 4 ? 
                                   normalizedKeyword.slice(0, -2) : 
                                   normalizedKeyword.slice(0, -1);
                       
                       if (stem.length >= 3 && words.some(word => word.startsWith(stem))) {
                           score += 1 * topic.weight;
                           matches.push(keyword);
                       }
                   }
               });

               if (score > 0) {
                   const confidence = Math.min((score / (topic.keywords.length * 0.3)), 1);
                   
                   if (confidence >= 0.1) {
                       detectedTopics.push({
                           id: topicId,
                           score: score,
                           confidence: confidence,
                           matches: [...new Set(matches)]
                       });
                   }
               }
           });

           return detectedTopics.sort((a, b) => b.score - a.score);
       }

       function analyzeSentimentAdvanced(text, pros, cons, rating) {
           const fullText = normalizeText([text, pros, cons].filter(Boolean).join(' '));
           const words = fullText.split(' ');
           
           let sentimentScore = 0;
           let wordCount = 0;
           let details = {
               positiveWords: [],
               negativeWords: [],
               intensifiers: [],
               negators: []
           };

           for (let i = 0; i < words.length; i++) {
               const word = words[i];
               const prevWord = i > 0 ? words[i-1] : '';
               
               let wordScore = 0;
               let isIntensified = false;
               let isNegated = false;

               if (SENTIMENT_LEXICON.intensifiers.includes(prevWord)) {
                   isIntensified = true;
                   details.intensifiers.push(prevWord);
               }

               if (SENTIMENT_LEXICON.negators.includes(prevWord) || 
                   (i > 1 && SENTIMENT_LEXICON.negators.includes(words[i-2]))) {
                   isNegated = true;
                   details.negators.push(prevWord || words[i-2]);
               }

               if (SENTIMENT_LEXICON.very_positive.includes(word)) {
                   wordScore = 3;
                   details.positiveWords.push(word);
               } else if (SENTIMENT_LEXICON.positive.includes(word)) {
                   wordScore = 2;
                   details.positiveWords.push(word);
               } else if (SENTIMENT_LEXICON.mild_positive.includes(word)) {
                   wordScore = 1;
                   details.positiveWords.push(word);
               } else if (SENTIMENT_LEXICON.very_negative.includes(word)) {
                   wordScore = -3;
                   details.negativeWords.push(word);
               } else if (SENTIMENT_LEXICON.negative.includes(word)) {
                   wordScore = -2;
                   details.negativeWords.push(word);
               } else if (SENTIMENT_LEXICON.mild_negative.includes(word)) {
                   wordScore = -1;
                   details.negativeWords.push(word);
               }

               if (wordScore !== 0) {
                   if (isIntensified) wordScore *= 1.5;
                   if (isNegated) wordScore *= -1;
                   
                   sentimentScore += wordScore;
                   wordCount++;
               }
           }

           if (rating) {
               const ratingWeight = 2;
               if (rating >= 4.5) {
                   sentimentScore += 3 * ratingWeight;
               } else if (rating >= 3.5) {
                   sentimentScore += 1 * ratingWeight;
               } else if (rating <= 1.5) {
                   sentimentScore -= 3 * ratingWeight;
               } else if (rating <= 2.5) {
                   sentimentScore -= 1 * ratingWeight;
               }
           }

           if (pros) sentimentScore += normalizeText(pros).split(' ').length * 0.5;
           if (cons) sentimentScore -= normalizeText(cons).split(' ').length * 0.5;

           const confidence = wordCount > 0 ? Math.min(wordCount / 5, 1) : 0.3;

           let sentiment;
           if (sentimentScore > 1) {
               sentiment = 'positive';
           } else if (sentimentScore < -1) {
               sentiment = 'negative';
           } else {
               sentiment = 'mixed';
           }

           return {
               sentiment: sentiment,
               score: sentimentScore,
               confidence: confidence,
               details: details,
               wordCount: wordCount
           };
       }

       function generateSampleData(count) {
           const companies = ['TechCorp', 'InnovaSoft', 'DataMax', 'CloudFirst', 'AICompany', 'StartupXYZ', 'DigitalPlus', 'CodeFactory'];
           const positions = ['Desenvolvedor Senior', 'Analista de Sistemas', 'Gerente de Produto', 'Coordenador de TI', 
                            'Especialista em Dados', 'Consultor', 'Designer UX', 'Engenheiro DevOps', 'Arquiteto de Software'];
           const locations = ['S√£o Paulo', 'Rio de Janeiro', 'Belo Horizonte', 'Porto Alegre', 'Curitiba', 'Salvador', 'Recife', 'Bras√≠lia'];
           
           const prosTemplates = [
               'Excelente ambiente de trabalho com colegas muito colaborativos e receptivos. A cultura da empresa √© realmente fant√°stica.',
               'Benef√≠cios incr√≠veis incluindo plano de sa√∫de premium, vale refei√ß√£o generoso, academia e aux√≠lio home office.',
               'Oportunidades de crescimento e desenvolvimento profissional constantes. Sempre h√° treinamentos e cursos dispon√≠veis.',
               'Sal√°rio muito competitivo com bonifica√ß√µes anuais e participa√ß√£o nos lucros. Reconhecimento financeiro adequado.',
               'Flexibilidade total para trabalho remoto e hor√°rios flex√≠veis. Work-life balance √© prioridade real.',
               'Gest√£o transparente e lideran√ßa inspiradora. Os managers realmente se preocupam com o desenvolvimento da equipe.',
               'Diversidade e inclus√£o s√£o levadas muito a s√©rio. Ambiente seguro para todos os tipos de pessoas.',
               'Tecnologia de ponta e ferramentas modernas. Sempre usando as melhores solu√ß√µes do mercado.',
               'Escrit√≥rio incr√≠vel com estrutura moderna, salas confort√°veis e √°reas de descanso bem planejadas.',
               'Cultura inovadora que encoraja criatividade e pensamento fora da caixa. Liberdade para experimentar.'
           ];

           const consTemplates = [
               'Sal√°rio abaixo da m√©dia do mercado para a regi√£o. Falta competitividade salarial comparado aos concorrentes.',
               'Poucas oportunidades de promo√ß√£o e crescimento interno. Carreira fica estagnada ap√≥s algum tempo.',
               'Gest√£o desorganizada com comunica√ß√£o deficiente entre os times. Falta alinhamento estrat√©gico.',
               'Excesso de trabalho e press√£o constante por resultados. Cultura de horas extras n√£o remuneradas.',
               'Benef√≠cios limitados comparado ao que outras empresas oferecem. Plano de sa√∫de b√°sico demais.',
               'Ambiente pol√≠tico com falta de transpar√™ncia nas decis√µes importantes. Muita burocracia interna.',
               'Equipamentos desatualizados e problemas constantes de infraestrutura de TI. Sistemas lentos.',
               'Falta de equil√≠brio entre vida pessoal e trabalho. Cobran√ßa excessiva inclusive nos finais de semana.',
               'Processos burocr√°ticos extremamente lentos para aprova√ß√µes e mudan√ßas. Excesso de hierarquia.',
               'Cultura t√≥xica em alguns departamentos com microgerenciamento e falta de autonomia para as equipes.'
           ];

           const data = [];
           
           for (let i = 0; i < count; i++) {
               const rating = Math.random() * 5;
               const company = companies[Math.floor(Math.random() * companies.length)];
               const position = positions[Math.floor(Math.random() * positions.length)];
               const location = locations[Math.floor(Math.random() * locations.length)];
               
               let pros = '';
               let cons = '';
               
               if (rating >= 4) {
                   pros = prosTemplates[Math.floor(Math.random() * prosTemplates.length)] + ' ' +
                          prosTemplates[Math.floor(Math.random() * prosTemplates.length)];
                   if (Math.random() > 0.6) {
                       cons = consTemplates[Math.floor(Math.random() * consTemplates.length)];
                   }
               } else if (rating >= 3) {
                   pros = prosTemplates[Math.floor(Math.random() * prosTemplates.length)];
                   cons = consTemplates[Math.floor(Math.random() * consTemplates.length)];
               } else {
                   if (Math.random() > 0.4) {
                       pros = prosTemplates[Math.floor(Math.random() * prosTemplates.length)];
                   }
                   cons = consTemplates[Math.floor(Math.random() * consTemplates.length)] + ' ' +
                          consTemplates[Math.floor(Math.random() * consTemplates.length)];
               }

               data.push({
                   'Avalia√ß√£o Geral': Number(rating.toFixed(1)),
                   'T√≠tulo da Avalia√ß√£o': `Experi√™ncia em ${company} - ${position}`,
                   'Pr√≥s': pros,
                   'Contras': cons,
                   'Cargo': position,
                   'Pa√≠s': location,
                   'Status do Funcion√°rio': Math.random() > 0.25 ? 'Atual' : 'Ex-funcion√°rio',
                   'Empresa': company,
                   'Data': new Date(2020 + Math.floor(Math.random() * 4), Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1).toISOString().split('T')[0]
               });
           }
           return data;
       }

       // üìä FUN√á√ïES PRINCIPAIS
       function selectFile() {
           document.getElementById('fileInput').click();
       }

       function loadSampleData() {
           showLoading('Gerando dataset de 100 reviews...');
           const data = generateSampleData(100);
           setTimeout(() => processData(data), 500);
       }

       function loadMegaDataset() {
           showLoading('Gerando MEGA dataset de 2000+ reviews...');
           const data = generateSampleData(2500);
           setTimeout(() => processData(data), 500);
       }

       function showLoading(text) {
           document.getElementById('loading').style.display = 'block';
           document.getElementById('loadingText').textContent = text;
           document.getElementById('results').style.display = 'none';
       }

       function hideLoading() {
           document.getElementById('loading').style.display = 'none';
       }

       function processData(data) {
           const startTime = Date.now();
           
           showProgress(0, `üöÄ Iniciando an√°lise NLP avan√ßada de ${data.length.toLocaleString()} reviews...`);
           
           const processed = {
               reviews: [],
               topicStats: {},
               sentimentStats: { positive: 0, negative: 0, mixed: 0 },
               nlpStats: { totalWords: 0, avgConfidence: 0, topicMatches: 0, sentimentWords: 0 }
           };

           Object.keys(ADVANCED_TOPICS).forEach(topicId => {
               processed.topicStats[topicId] = { 
                   positive: 0, negative: 0, mixed: 0, total: 0, 
                   avgConfidence: 0, totalScore: 0, reviews: [] 
               };
           });

           data.forEach((row, index) => {
               const review = {
                   id: index + 1,
                   title: row['T√≠tulo da Avalia√ß√£o'] || `Review ${index + 1}`,
                   rating: parseFloat(row['Avalia√ß√£o Geral'] || 0),
                   pros: row['Pr√≥s'] || row.Pros || '',
                   cons: row['Contras'] || row.Cons || '',
                   position: row['Cargo'] || 'N/A',
                   location: row['Pa√≠s'] || 'N/A',
                   status: row['Status do Funcion√°rio'] || 'N/A',
                   company: row['Empresa'] || 'Empresa'
               };

               review.fullText = `${review.title} ${review.pros} ${review.cons}`;
               
               const detectedTopics = detectTopicsAdvanced(review.fullText);
               review.topics = detectedTopics;
               
               const sentimentAnalysis = analyzeSentimentAdvanced(
                   review.fullText, review.pros, review.cons, review.rating
               );
               review.sentiment = sentimentAnalysis.sentiment;
               review.sentimentScore = sentimentAnalysis.score;
               review.sentimentConfidence = sentimentAnalysis.confidence;
               review.sentimentDetails = sentimentAnalysis.details;
               
               processed.nlpStats.totalWords += review.fullText.split(' ').length;
               processed.nlpStats.sentimentWords += sentimentAnalysis.wordCount;
               processed.nlpStats.topicMatches += detectedTopics.length;
               
               processed.sentimentStats[review.sentiment]++;

               detectedTopics.forEach(topicData => {
                   const topicId = topicData.id;
                   if (processed.topicStats[topicId]) {
                       processed.topicStats[topicId].total++;
                       processed.topicStats[topicId].totalScore += topicData.score;
                       processed.topicStats[topicId].avgConfidence += topicData.confidence;
                       processed.topicStats[topicId][review.sentiment]++;
                       processed.topicStats[topicId].reviews.push(review);
                   }
               });

               processed.reviews.push(review);

               if (index % 100 === 0 || index === data.length - 1) {
                   const progress = ((index + 1) / data.length) * 100;
                   const speed = Math.round((index + 1) / ((Date.now() - startTime) / 1000));
                   showProgress(progress, `‚ö° Processadas ${(index + 1).toLocaleString()}/${data.length.toLocaleString()} reviews (${speed}/s)`);
               }
           });
           
           Object.keys(processed.topicStats).forEach(topicId => {
               const stats = processed.topicStats[topicId];
               if (stats.total > 0) {
                   stats.avgConfidence = stats.avgConfidence / stats.total;
               }
           });
           
           const processingTime = (Date.now() - startTime) / 1000;
           
           setTimeout(() => {
               hideProgress();
               hideLoading();
               displayResults(processed, processingTime);
           }, 300);
       }

       function showProgress(percent, text) {
           document.getElementById('progress').style.display = 'block';
           document.getElementById('progressBar').style.width = percent + '%';
           document.getElementById('status').style.display = 'block';
           document.getElementById('status').textContent = text;
       }

       function hideProgress() {
           document.getElementById('progress').style.display = 'none';
           document.getElementById('status').style.display = 'none';
       }

       function displayResults(data, processingTime) {
           allReviews = data.reviews;
           filteredReviews = [...allReviews];

           const total = data.sentimentStats.positive + data.sentimentStats.negative + data.sentimentStats.mixed;
           const positivePercent = Math.round((data.sentimentStats.positive / total) * 100);
           const activeTopics = Object.keys(data.topicStats).filter(t => data.topicStats[t].total > 0).length;

           document.getElementById('totalReviews').textContent = total.toLocaleString();
           document.getElementById('processingTime').textContent = processingTime.toFixed(1) + 's';
           document.getElementById('positivePercent').textContent = positivePercent + '%';
           document.getElementById('topicsCount').textContent = activeTopics;

           const ctx = document.getElementById('sentimentChart').getContext('2d');
           new Chart(ctx, {
               type: 'doughnut',
               data: {
                   labels: [
                       `Positivo (${data.sentimentStats.positive})`, 
                       `Neutro (${data.sentimentStats.mixed})`, 
                       `Negativo (${data.sentimentStats.negative})`
                   ],
                   datasets: [{
                       data: [data.sentimentStats.positive, data.sentimentStats.mixed, data.sentimentStats.negative],
                       backgroundColor: ['#48bb78', '#ed8936', '#f56565'],
                       borderWidth: 3,
                       borderColor: '#fff'
                   }]
               },
               options: {
                   responsive: true,
                   plugins: { 
                       legend: { position: 'bottom', labels: { padding: 20, font: { size: 12 } } },
                       tooltip: {
                           callbacks: {
                               label: function(context) {
                                   const value = context.parsed;
                                   const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                   const percentage = Math.round((value / total) * 100);
                                   return `${context.label}: ${percentage}%`;
                               }
                           }
                       }
                   }
               }
           });

           const topicsGrid = document.getElementById('topicsGrid');
           topicsGrid.innerHTML = '';
           
           const sortedTopics = Object.entries(data.topicStats)
               .filter(([topicId, stats]) => stats.total > 0)
               .sort(([,a], [,b]) => b.total - a.total);
           
           sortedTopics.forEach(([topicId, stats]) => {
               const positivePerc = Math.round((stats.positive / stats.total) * 100);
               const confidence = Math.round(stats.avgConfidence * 100);
               
               let borderColor = '#e2e8f0';
               if (positivePerc >= 70) {
                   borderColor = '#48bb78';
               } else if (positivePerc <= 30) {
                   borderColor = '#f56565';
               } else {
                   borderColor = '#ed8936';
               }
               
               const card = document.createElement('div');
               card.className = 'topic-card';
               card.style.borderLeftColor = borderColor;
               card.innerHTML = `
                   <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                       <span style="font-weight: 600; font-size: 1.1rem;">
                           ${ADVANCED_TOPICS[topicId].icon} ${ADVANCED_TOPICS[topicId].name}
                       </span>
                       <span style="font-size: 1.4rem; font-weight: 700; color: ${positivePerc >= 70 ? '#48bb78' : positivePerc <= 30 ? '#f56565' : '#ed8936'};">
                           ${positivePerc}%
                       </span>
                   </div>
                   <div style="font-size: 0.95rem; color: #666; margin-bottom: 0.75rem;">
                       üìä ${stats.total.toLocaleString()} men√ß√µes ‚Ä¢ üéØ Confian√ßa: ${confidence}%
                   </div>
                   <div style="background: #e2e8f0; height: 8px; border-radius: 4px; overflow: hidden; margin-bottom: 0.75rem;">
                       <div style="background: ${positivePerc >= 70 ? '#48bb78' : positivePerc <= 30 ? '#f56565' : '#ed8936'}; height: 100%; width: ${positivePerc}%; transition: width 0.5s ease;"></div>
                   </div>
                   <div style="font-size: 0.85rem; color: #718096;">
                       ‚úÖ ${stats.positive} positivas ‚Ä¢ ‚öñÔ∏è ${stats.mixed} neutras ‚Ä¢ ‚ùå ${stats.negative} negativas
                   </div>
               `;
               topicsGrid.appendChild(card);
           });

           const topicFilter = document.getElementById('topicFilter');
           topicFilter.innerHTML = '<option value="">üéØ Todos os T√≥picos</option>';
           
           sortedTopics.forEach(([topicId, stats]) => {
               const option = document.createElement('option');
               option.value = topicId;
               option.textContent = `${ADVANCED_TOPICS[topicId].icon} ${ADVANCED_TOPICS[topicId].name} (${stats.total})`;
               topicFilter.appendChild(option);
           });

           applyFilters();
           document.getElementById('results').style.display = 'block';
       }

       function applyFilters() {
           const topicFilter = document.getElementById('topicFilter').value;
           const sentimentFilter = document.getElementById('sentimentFilter').value;

           filteredReviews = allReviews.filter(review => {
               const matchesTopic = !topicFilter || review.topics.some(t => t.id === topicFilter);
               const matchesSentiment = !sentimentFilter || review.sentiment === sentimentFilter;
               return matchesTopic && matchesSentiment;
           });

           currentPage = 1;
           displayReviews();
       }

       function displayReviews() {
           const startIndex = (currentPage - 1) * itemsPerPage;
           const endIndex = startIndex + itemsPerPage;
           const pageReviews = filteredReviews.slice(startIndex, endIndex);

           document.getElementById('reviewCount').textContent = filteredReviews.length.toLocaleString();

           const reviewsList = document.getElementById('reviewsList');
           reviewsList.innerHTML = pageReviews.map(review => {
               const sentimentColor = {
                   positive: '#48bb78',
                   negative: '#f56565',
                   mixed: '#ed8936'
               }[review.sentiment];

               const stars = '‚òÖ'.repeat(Math.round(review.rating)) + '‚òÜ'.repeat(5 - Math.round(review.rating));
               
               const topicsDisplay = review.topics.map(topicData => {
                   const topic = ADVANCED_TOPICS[topicData.id];
                   const confidence = Math.round(topicData.confidence * 100);
                   return `${topic.icon} ${topic.name} (${confidence}%)`;
               }).join(', ') || 'Nenhum t√≥pico detectado';
               
               const sentimentWords = [];
               if (review.sentimentDetails) {
                   if (review.sentimentDetails.positiveWords.length > 0) {
                       sentimentWords.push(`‚úÖ ${review.sentimentDetails.positiveWords.slice(0, 3).join(', ')}`);
                   }
                   if (review.sentimentDetails.negativeWords.length > 0) {
                       sentimentWords.push(`‚ùå ${review.sentimentDetails.negativeWords.slice(0, 3).join(', ')}`);
                   }
               }
               
               return `
                   <div class="review-item" style="border-left-color: ${sentimentColor}">
                       <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                           <strong style="flex: 1; font-size: 1.1rem;">${review.title}</strong>
                           <div style="text-align: right;">
                               <div style="font-size: 1.1rem;">${stars} (${review.rating})</div>
                               <div style="font-size: 0.85rem; color: ${sentimentColor}; font-weight: 600; margin-top: 0.25rem;">
                                   ${review.sentiment.toUpperCase()} 
                                   (${Math.round(review.sentimentConfidence * 100)}% confian√ßa)
                               </div>
                           </div>
                       </div>
                       
                       <div style="font-size: 0.95rem; color: #666; margin-bottom: 1rem; padding: 0.5rem; background: rgba(0,0,0,0.02); border-radius: 6px;">
                           üë§ ${review.position} ‚Ä¢ üìç ${review.location} ‚Ä¢ ${review.status} ‚Ä¢ üè¢ ${review.company}
                       </div>
                       
                       ${review.pros ? `
                           <div style="color: #48bb78; margin: 0.75rem 0; padding: 0.75rem; background: #f0fff4; border-radius: 8px; border-left: 4px solid #48bb78;">
                               <strong>‚ûï Pontos Positivos:</strong><br>${review.pros}
                           </div>
                       ` : ''}
                       
                       ${review.cons ? `
                           <div style="color: #f56565; margin: 0.75rem 0; padding: 0.75rem; background: #fff5f5; border-radius: 8px; border-left: 4px solid #f56565;">
                               <strong>‚ûñ Pontos Negativos:</strong><br>${review.cons}
                           </div>
                       ` : ''}
                       
                       <div style="border-top: 1px solid #e2e8f0; padding-top: 1rem; margin-top: 1rem;">
                           <div style="font-size: 0.85rem; color: #4a5568; margin-bottom: 0.5rem;">
                               <strong>üéØ T√≥picos NLP Detectados:</strong><br>${topicsDisplay}
                           </div>
                           ${sentimentWords.length > 0 ? `
                               <div style="font-size: 0.85rem; color: #4a5568;">
                                   <strong>üí≠ Palavras-chave de Sentimento:</strong> ${sentimentWords.join(' ‚Ä¢ ')}
                               </div>
                           ` : ''}
                       </div>
                   </div>
               `;
           }).join('');

           displayPagination();
       }

       function displayPagination() {
           const totalPages = Math.ceil(filteredReviews.length / itemsPerPage);
           const pagination = document.getElementById('pagination');

           if (totalPages <= 1) {
               pagination.innerHTML = '';
               return;
           }

           let paginationHTML = '';
           
           if (currentPage > 1) {
               paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage - 1})">‚Üê Anterior</button>`;
           }
           
           const startPage = Math.max(1, currentPage - 2);
           const endPage = Math.min(totalPages, currentPage + 2);
           
           for (let i = startPage; i <= endPage; i++) {
               paginationHTML += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
           }
           
           if (currentPage < totalPages) {
               paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage + 1})">Pr√≥xima ‚Üí</button>`;
           }

           paginationHTML += `<span style="margin-left: 1rem; color: #718096;">P√°gina ${currentPage} de ${totalPages}</span>`;
           pagination.innerHTML = paginationHTML;
       }

       function goToPage(page) {
           currentPage = page;
           displayReviews();
       }

       // üéß EVENT LISTENERS
       document.getElementById('fileInput').addEventListener('change', function(event) {
           const file = event.target.files[0];
           if (!file) return;

           showLoading('üìä Carregando e processando arquivo Excel...');

           const reader = new FileReader();
           reader.onload = function(e) {
               try {
                   const data = new Uint8Array(e.target.result);
                   const workbook = XLSX.read(data, { type: 'array' });
                   const sheetName = workbook.SheetNames[0];
                   const worksheet = workbook.Sheets[sheetName];
                   const jsonData = XLSX.utils.sheet_to_json(worksheet);
                   
                   if (jsonData.length === 0) {
                       alert('‚ùå Arquivo vazio ou formato inv√°lido. Verifique se o arquivo cont√©m dados.');
                       hideLoading();
                       return;
                   }
                   
                   processData(jsonData);
               } catch (error) {
                   hideLoading();
                   alert('‚ùå Erro ao processar arquivo: ' + error.message);
               }
           };
           reader.readAsArrayBuffer(file);
       });

       document.getElementById('topicFilter').addEventListener('change', applyFilters);
       document.getElementById('sentimentFilter').addEventListener('change', applyFilters);

       // üöÄ INICIALIZA√á√ÉO
       console.log('üß† Review Intelligence‚Ñ¢ Enterprise - Sistema NLP Carregado');
       console.log('üìä Funcionalidades: Upload Excel, 9 T√≥picos Avan√ßados, An√°lise de Sentimento Contextual');
       console.log('‚ö° Performance: Otimizado para +2000 reviews');
   </script>
</body>
</html>
